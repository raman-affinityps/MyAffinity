google.load("visualization","1",{packages:["corechart","bar","gauge","scatter"]});var wpDataTablesGoogleChart=function(){var t={rows:[],columns:[],type:"column",containerId:"googleChartContainer",columnIndexes:[],connectedWPDataTable:null,chart:null,googleDataTable:null,renderCallback:null,options:{width:400,height:400,animation:{duration:1e3,easing:"out",startup:!0}},setRows:function(t){this.rows=t},detectDates:function(){for(var t in this.columns)if("date"==this.columns[t].type)for(var e in this.rows){var a=Date.parse(this.rows[e][t]);isNaN(a)?this.rows[e][t]=new Date:this.rows[e][t]=new Date(a)}},setColumns:function(t){this.columns=t},getColumns:function(){return this.columns},setOptions:function(t){for(var e in t)this.options[e]=t[e]},getOptions:function(){return this.options},setType:function(t){this.type=t},getType:function(){return this.type},setContainer:function(t){this.containerId=t},getContainer:function(){return this.containerId},setRenderCallback:function(t){this.renderCallback=t},render:function(){this.googleDataTable=new google.visualization.DataTable;for(var t in this.columns)this.googleDataTable.addColumn(this.columns[t]);switch(this.detectDates(),this.googleDataTable.addRows(this.rows),this.type){case"google_column_chart":this.chart=new google.visualization.ColumnChart(document.getElementById(this.containerId));break;case"google_histogram":this.chart=new google.visualization.Histogram(document.getElementById(this.containerId));break;case"google_bar_chart":this.options.bars="horizontal",this.chart=new google.charts.Bar(document.getElementById(this.containerId));break;case"google_area_chart":this.chart=new google.visualization.AreaChart(document.getElementById(this.containerId));break;case"google_stepped_area_chart":this.options.isStacked=!0,this.chart=new google.visualization.SteppedAreaChart(document.getElementById(this.containerId));break;case"google_line_chart":this.options.curveType="function",this.chart=new google.visualization.LineChart(document.getElementById(this.containerId));break;case"google_pie_chart":this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_bubble_chart":this.chart=new google.visualization.BubbleChart(document.getElementById(this.containerId));break;case"google_donut_chart":this.options.pieHole=.4,this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_gauge_chart":this.options.redFrom=90,this.options.redTo=100,this.options.yellowFrom=75,this.options.yellowTo=90,this.options.minorTicks=5,this.chart=new google.visualization.Gauge(document.getElementById(this.containerId));break;case"google_scatter_chart":this.chart=new google.charts.Scatter(document.getElementById(this.containerId)),this.options=google.charts.Scatter.convertOptions(this.options);break;case"google_candlestick_chart":this.chart=new google.visualization.CandlestickChart(document.getElementById(this.containerId))}null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},refresh:function(){this.googleDataTable=new google.visualization.DataTable;for(var t in this.columns)this.googleDataTable.addColumn(this.columns[t]);this.detectDates(),this.googleDataTable.addRows(this.rows),null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},setConnectedWPDataTable:function(t){this.connectedWPDataTable=t},getConnectedWPDataTable:function(){return this.connectedWPDataTable},enableFollowFiltering:function(){null!=this.connectedWPDataTable&&this.connectedWPDataTable.fnSettings().aoDrawCallback.push({sName:"chart_filter_follow",fn:function(e){var a=[];t.options.animation=!1;var o=t.connectedWPDataTable._("tr",{filter:"applied"}).toArray(),n=jQuery.parseJSON(jQuery("#"+t.connectedWPDataTable.data("described-by")).val()).datepickFormat,i=jQuery.parseJSON(jQuery("#"+t.connectedWPDataTable.data("described-by")).val()).number_format;for(var s in o){var r=[];for(var l in t.columnIndexes)if("number"==t.columns[l].type){var c=o[s][t.columnIndexes[l]];isNaN(c)&&(c=1==i?c.replace(/\./g,"").replace(",","."):c.replace(/,/g,"")),r.push(parseFloat(c))}else"date"==t.columns[l].type?r.push(jQuery.datepicker.parseDate(n,o[s][t.columnIndexes[l]])):r.push(o[s][t.columnIndexes[l]]);a.push(r)}t.rows=a,t.refresh()}})},setColumnIndexes:function(t){this.columnIndexes=t},getColumnIndexes:function(){return this.columnIndexes}};return t};