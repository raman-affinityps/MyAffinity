var inlineEditClass=function(a,e,t){var l={params:{tableId:a.tableId,currentCell:"",editInputId:"dt_cell_edit",editSelector:"#dt_cell_edit",validationPopover:'<div class="wpDataTablesPopover editError"></div>',value:"",table:"",cellData:"",cellInfo:"",rowId:"",columnId:"",columnType:"",inputType:"",columnHeader:"",notNull:"",code:"",expandButton:"",valid:!0,additionalValid:!0,dateFormat:a.datepickFormat.replace(/y/g,"yy").replace(/Y/g,"yyyy").replace(/M/g,"mmm")},removeSelection:function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var a=window.getSelection();a.removeAllRanges()}},setErrorPopoverPosition:function(a,e){var t="",l=a.offset(),r=a.outerWidth(!0),s=(a.outerHeight(!0),l.left+r/2-e.width/2),i=l.top-e.height;return t={top:i,left:s}},parseLink:function(){if(-1!=l.params.value.indexOf("<a "))if(-1!==t.inArray(l.params.inputType,["text","link","textarea","email"])){var a=t(l.params.value);-1===a.attr("href").indexOf(a.html())?l.params.value=a.attr("href").replace("mailto:","")+"||"+a.html():l.params.value=a.html()}else l.params.value=t(l.params.value).html()},saveData:function(e,r,s){t(a.selector).addClass("overlayed"),wpDataTables[l.params.tableId].fnUpdate(e,r,s,0,0);var i=wpDataTables[l.params.tableId].fnGetData(r);wpDataTablesFunctions[l.params.tableId].applyData(i),wpDataTablesFunctions[l.params.tableId].saveTableData(1),t(a.selector).find("td").removeClass("editing")},fieldValidation:function(a,e){if(""!=l.params.value){if("email"==a)var r=wdtValidateEmail(l.params.value),s=wpdatatables_frontend_strings.invalid_email;else if("link"==a)var r=wdtValidateURL(l.params.value),s=wpdatatables_frontend_strings.invalid_link;if(r)t(this).closest("td").removeClass("error"),l.params.valid=!0,l.params.additionalValid=!0;else{if(!e.closest("td").hasClass("error")){e.closest("td").addClass("error"),t("body").prepend(l.params.validationPopover),t(".wpDataTablesPopover.editError").html(s);var i={width:t(".wpDataTablesPopover.editError").outerWidth(),height:t(".wpDataTablesPopover.editError").outerHeight()+7};t(".wpDataTablesPopover.editError").css(l.setErrorPopoverPosition(e,i)),setTimeout(function(){t(".wpDataTablesPopover.editError").fadeOut("300",function(){t(this).remove(),e.closest("td").removeClass("error")})},2e3)}l.params.valid=!1,l.params.additionalValid=!1}}else l.params.valid=!0,l.params.additionalValid=!0},mandatoryFieldValidation:function(a){if(""!=a.val()&&l.params.additionalValid)a.closest("td").removeClass("error"),l.params.valid=!0;else if(!a.closest("td").hasClass("error")){a.closest("td").addClass("error"),t("body").prepend(l.params.validationPopover),t(".wpDataTablesPopover.editError").html(wpdatatables_frontend_strings.cannot_be_empty);var e={width:t(".wpDataTablesPopover.editError").outerWidth(),height:t(".wpDataTablesPopover.editError").outerHeight()+7};t(".wpDataTablesPopover.editError").css(l.setErrorPopoverPosition(a,e)),setTimeout(function(){t(".wpDataTablesPopover.editError").fadeOut("300",function(){t(this).remove(),a.closest("td").removeClass("error")})},2e3),l.params.valid=!1}},validateAndSave:function(e){var r=new Array("email","link");-1!==t.inArray(l.params.inputType,r)?(l.fieldValidation(l.params.inputType,e),l.params.notNull&&l.mandatoryFieldValidation(e)):l.params.notNull&&l.mandatoryFieldValidation(e),l.params.valid&&("date"==l.params.inputType?datePickerInit(a.selector+" .row_edit_datepicker",additional_params,"opened"):t.when(l.saveData(l.params.value,l.params.rowId,l.params.columnId)).then(l.params.currentCell.prepend(l.params.expandButton)))},FieldTypeMethods:{noneditableCell:function(){l.params.currentCell.removeClass("editing");var a=l.params.currentCell,e=l.params.currentCell.html();l.params.currentCell.empty().html("You can't edit this field"),t(document).click(function(){a.html(e)})},textCell:function(){l.parseLink(),l.params.code='<input type="text" data-input_type="'+l.params.inputType+'" id="'+l.params.editInputId+"\" value='"+l.params.value+"' />",l.params.currentCell.empty().append(l.params.code),t(l.params.editSelector).focus(),t(l.params.editSelector).blur(function(){l.params.value=t(this).val(),l.validateAndSave(t(this))})},textareaCell:function(){l.parseLink(),-1!=l.params.value.indexOf("<br/>")&&(l.params.value=l.params.value.replace(/<br\/>/g,"\n")),l.params.code='<textarea data-input_type="'+l.params.inputType+'" id="'+l.params.editInputId+'" rows="3" columns="50">'+l.params.value+"</textarea>",l.params.currentCell.empty().append(l.params.code),t(l.params.editSelector).focus(),t(l.params.editSelector).blur(function(){l.params.value=t(this).val(),l.validateAndSave(t(this))})},linkCell:function(){l.parseLink(),l.params.code='<input type="text" data-input_type="'+l.params.inputType+'" id="'+l.params.editInputId+'" value="'+l.params.value+'" />',l.params.currentCell.empty().append(l.params.code),t(l.params.editSelector).focus(),t(l.params.editSelector).blur(function(){l.params.value=t(this).val(),l.validateAndSave(t(this))})},dateCell:function(){l.params.code='<input type="text" class="row_edit_datepicker" data-input_type="'+l.params.inputType+'" id="'+l.params.editInputId+'" value="'+l.params.value+'" />',l.params.currentCell.empty().append(l.params.code);var e=function(){l.params.value=t(l.params.editSelector).val(),t.when(l.saveData(l.params.value,l.params.rowId,l.params.columnId)).then(t(l.params.editSelector).prepend(l.params.expandButton))};l.params.valid&&l.datePickerInit(a.selector+" .row_edit_datepicker",e,"opened")},selectboxCell:function(){l.params.code=t("#"+a.tableId+"_"+l.params.columnHeader).clone(),l.params.currentCell.empty().append(l.params.code.attr("id",l.params.editInputId).removeClass("selecter-element")),null!==l.params.value&&t.each(l.params.value.split(", "),function(a,e){t(l.params.editSelector+' option[value="'+e+'"]').prop("selected",!0)}),t(l.params.editSelector).selecter().focus(),"selectbox"==l.params.inputType?(l.params.currentCell.css({overflow:"initial"}),t(l.params.editSelector).change(function(){l.params.value=t(this).val(),"array"===t.type(l.params.value)&&(l.params.value=l.params.value.join(", ")),l.validateAndSave(t(this))})):t(l.params.editSelector).closest(".selecter").blur(function(){l.params.value=t("#"+l.params.editInputId).val(),"array"===t.type(l.params.value)&&(l.params.value=l.params.value.join(", ")),l.validateAndSave(t(this))})},attachmentCell:function(){l.params.value="";var e="",r="";l.params.currentCell.find("img").length>0?l.params.currentCell.find("img").attr("src").length>0&&(e=l.params.currentCell.find("img").attr("src")):l.params.currentCell.find("a").length>0?l.params.currentCell.find("a").attr("href").length>0&&(e=l.params.currentCell.find("a").attr("href")):e=l.params.currentCell.html();var s=e.substring(e.lastIndexOf("/")+1);r="<p>"+s+' [<a href="#" data-key="row_edit_'+a.tableId+'_sets" class="wdtdeleteFile">'+wpdatatables_frontend_strings.detach_file+"</a>]</p>",l.params.code='<span class="fileinput-button">\n				   <button id="row_edit_'+a.tableId+'_sets_button" data-column_type="icon" data-rel_input="row_edit_'+a.tableId+'_sets" class="btn fileupload_row_edit_'+a.tableId+'">'+wpdatatables_frontend_strings.browse_file+'</button>\n				   <input type="hidden" id="row_edit_'+a.tableId+'_sets" data-key="sets" data-input_type="attachment" class="editDialogInput" value="'+e+'" />\n				   <button class="btn row_edit_fileupload_submit_'+a.tableId+'">'+wpdatatables_frontend_strings.ok+'</button>\n			       </span>\n			       <div id="files_row_edit_'+a.tableId+'_sets" class="files">'+r+"</div>",l.params.currentCell.empty().append(l.params.code),l.fileUploadInit("row_edit_"+a.tableId),t(".row_edit_fileupload_submit_"+a.tableId).click(function(){l.params.value=t("#row_edit_"+a.tableId+"_sets").val(),l.params.value='<a href="'+l.params.value+'"></a>',t("#row_edit_"+a.tableId+"_sets").closest("td").empty().html(l.params.value),l.validateAndSave(t(this))})}},fileUploadInit:function(a){t(".fileupload_"+a).length&&(wdtCustomUploader=wp.media({title:wpdatatables_frontend_strings.select_upload_file,button:{text:wpdatatables_frontend_strings.choose_file},multiple:!1}),t("button.fileupload_"+a).click(function(a){a.preventDefault();var e=t(this),r=t("#"+e.data("rel_input"));"icon"==l.params.columnType?(wdtCustomUploader=wp.media({title:wpdatatables_frontend_strings.select_upload_file,button:{text:wpdatatables_frontend_strings.choose_file},multiple:!1,library:{type:"image"}}),wdtCustomUploader.off("select").on("select",function(){attachment=wdtCustomUploader.state().get("selection").first().toJSON(),r.val(attachment.sizes.thumbnail.url+"||"+attachment.url),t("#files_"+e.data("rel_input")).html("<p>"+attachment.filename+' [<a href="#" data-key="'+e.data("rel_input")+'" class="wdtdeleteFile">'+wpdatatables_frontend_strings.detach_file+"</a>]</p>")})):wdtCustomUploader.off("select").on("select",function(){attachment=wdtCustomUploader.state().get("selection").first().toJSON(),r.val(attachment.url),t("#files_"+e.data("rel_input")).html("<p>"+attachment.filename+' [<a href="#" data-key="'+e.data("rel_input")+'" class="wdtdeleteFile">'+wpdatatables_frontend_strings.detach_file+"</a>]</p>")}),wdtCustomUploader.open()}))},datePickerInit:function(a,e,r){var s=t(a).pickadate({format:l.params.dateFormat,formatSubmit:l.params.dateFormat,selectYears:20,selectMonths:!0,container:".wpDataTablesWrapper",onClose:e}),i=s.pickadate("picker");"opened"==r&&i.open()},bindClickEvent:function(){t(a.selector).on("dblclick","td",function(r){var s=r.target||r.srcElement,i=s.tagName.toLowerCase();if("input"==i||!l.params.valid||t(this).hasClass("editing"))return!1;switch(l.removeSelection(),t(this).addClass("editing"),l.params.table=t(a.selector).DataTable(),l.params.cellData=l.params.table.cell(this).data(),l.params.cellInfo=l.params.table.cell(this).index(),l.params.columnId=l.params.cellInfo.column,l.params.columnType=wpDataTables[l.params.tableId].fnSettings().aoColumns[l.params.columnId].wdtType,l.params.rowId=l.params.cellInfo.row,l.params.inputType=e.aoColumnDefs[l.params.columnId].InputType,l.params.columnHeader=e.aoColumnDefs[l.params.columnId].origHeader,l.params.notNull=e.aoColumnDefs[l.params.columnId].notNull,l.params.value=l.params.cellData,l.params.currentCell=t(this),""!=t(this).children(".responsiveExpander")&&(l.params.expandButton=t(this).children(".responsiveExpander")),l.params.inputType){case"none":l.FieldTypeMethods.noneditableCell();break;case"text":l.FieldTypeMethods.textCell();break;case"textarea":l.FieldTypeMethods.textareaCell();break;case"link":case"email":l.FieldTypeMethods.linkCell();break;case"date":l.FieldTypeMethods.dateCell();break;case"multi-selectbox":case"selectbox":l.FieldTypeMethods.selectboxCell();break;case"attachment":l.FieldTypeMethods.attachmentCell()}})}};l.bindClickEvent()};